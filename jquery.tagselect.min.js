/*
* jQuery TagSelect Plugin
*
* Copyright (c) 2011 Gamebase Inc. & Po-Huan, Lin a.k.a Linmic
* Mail: linmicya@gmail.com
*
* Licensed under MIT licenses:
*     http://www.opensource.org/licenses/mit-license.php
* Version: v0.3 2011-06-04
*
*/
(function(c){c.fn.extend({tagselect:function(i,d,f,e,l){function o(b){var a=typeof b;a==="object"&&(b?b instanceof Array&&(a="array"):a="null");return a}function p(b,a){var j=c.trim(b).split(a),d;for(d in j)j.hasOwnProperty(d)&&(j[d]=c.trim(j[d]));return j}function m(b){g.indexOfIg(b)==-1&&g.push(c.trim(b))}function k(){var b=p(f.val(),d);g=[];if(c.trim(f.val())!="")for(var a in b)b.hasOwnProperty(a)&&b[a]!=""&&g.indexOfIg(b[a])===-1&&m(b[a]);n.find("a").each(function(){b.indexOfIg(c(this).text())==
-1?c(this).removeClass("active"):c(this).addClass("active")})}Array.prototype.indexOfIg=function(b){if(o(b)!=="string")return!1;var a=[],b=b.toLowerCase(),c;for(c in this)this.hasOwnProperty(c)&&(a[c]=this[c].toLowerCase());return a.indexOf(b)};if(o(i)!=="array"||d!=","&&d!=" ")return!1;this.defaults={sep:" ",$input:c("#input1"),ac_enable:!1,ac_css:"http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/themes/base/jquery-ui.css"};var d=!d?this.defaults.sep:d,f=!f?this.defaults.$input:f,e=!e?this.defaults.ac_enable:
e,n=this,g=[];e==!0&&typeof f.autocomplete=="function"&&(e=!l?"http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/themes/base/jquery-ui.css":l,c("link#jqueryui_css").length==0&&(c("head").append("<link>"),c("head").children(":last").attr({id:"jqueryui_css",rel:"stylesheet",type:"text/css",href:e})),f.autocomplete({minLength:0,source:function(b,a){a(c.ui.autocomplete.filter(i,(d===","?b.term.split(/,\s*/):d===" "?b.term.split(/\s+/):b.term.split(d)).pop()))},focus:function(b){b.preventDefault()},
select:function(b,a){arr=g;arr.push(a.item.value);this.value=arr.join(d);f.focus().val(c.trim(g.join(d)));k();b.preventDefault()}}));e=0;for(l=i.length;e<l;e++)n.append('<a id="tag_'+e+'" href="#">'+i[e]+"</a>");f.bind("change, click",function(){k()}).bind("keyup",function(b){c.trim(f.val())==""&&k();switch(b.keyCode){case 32:case 188:d!=","&&k()}});n.find("a").bind("click",function(b){var a=c(this),e=c.trim(a.text());a.hasClass("active")?(a.removeClass("active"),g.indexOfIg(e)!=-1&&(a=g.indexOfIg(c.trim(e)),
a!=-1&&g.splice(a,1))):(a.addClass("active"),m(e));var a=p(f.val(),d),h;for(h in a)g.indexOfIg(a[h])===-1&&i.indexOfIg(a[h])===-1&&a[h]!==""&&a[h]!=e&&m(a[h]);f.focus().val(c.trim(g.join(d)));b.preventDefault()});f.focus(function(){this.value=this.value});k()}})})(jQuery);
